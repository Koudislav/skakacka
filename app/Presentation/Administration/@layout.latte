<!DOCTYPE html>
<html lang="cs">
<head>
	{include '../@head.latte'}
	<script src="https://cdn.tiny.cloud/1/{$config['tinymce_api_key']}/tinymce/6/tinymce.min.js" referrerpolicy="origin"></script>

	<title>{ifset title}{include title|stripHtml} | {/ifset} Administrace</title>
	{asset? 'main.js'}
</head>

<body class="d-flex flex-column min-vh-100">
	{snippet flashes}
		<div class="flashes">
			<div n:foreach="$flashes as $flash" n:class="flash, $flash->type, alert, 'alert-' . $flash->type, 'alert-dismissible fade show'" role="alert">
				{$flash->message}
				<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
			</div>
		</div>
	{/snippet}

	{include '@adminPanel.latte'}
	<div class="container flex-grow-1 pt-2">
		<div class="row">
			{ifset blockMenu}
				{* MOBILE TOGGLE BUTTON *}
				<div class="d-lg-none mb-2">
					<button class="btn btn-outline-primary w-100" type="button" data-bs-toggle="offcanvas" data-bs-target="#adminMenuCanvas">
						<i class="bi bi-list"></i> Menu
					</button>
				</div>

				{* DESKTOP SIDEBAR *}
				<div class="col-lg-3 d-none d-lg-block">
					{include blockMenu}
				</div>

				{* CONTENT *}
				<div class="col-12 col-lg-9">
					{include content}
				</div>

				{* MOBILE OFFCANVAS *}
				<div class="offcanvas offcanvas-start" tabindex="-1" id="adminMenuCanvas">
					<div class="offcanvas-header">
						<h5 class="offcanvas-title">Menu</h5>
						<button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
					</div>
					<div class="offcanvas-body">
						{include blockMenu}
					</div>
				</div>
			{else}
				<div class="col-12">
					{include content}
				</div>
			{/ifset}
		</div>
	</div>

	{include '../@bodyScripts.latte'}

	<!-- N1ED core -->
	<script src="https://cdn.n1ed.com/n1ed/tinymce/n1ed.min.js"></script>
	<link rel="stylesheet" href="https://cdn.n1ed.com/n1ed/tinymce/n1ed.min.css">
	<script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>

	{block scripts}
	<script>
	tinymce.init({
		selector: '.tiny-editor',
		relative_urls: false,
		extended_valid_elements: 'i[class]',
		paste_data_images: false,//not base64
		automatic_uploads: false,//not base64 upload
		image_file_types: 'jpg,jpeg,png,gif,webp,svg',

		plugins: [
			'code',
			'lists',
			'link',
			'table',
			'image',
			'n1ed',
			'fullscreen',
		],
			external_plugins: {
			n1ed: "https://cdn.n1ed.com/n1ed/tinymce/n1ed.min.js"
		},
		n1ed: {
			// Volitelné: konfigurace N1ED
			// URL k blokům / assets / Bootstrap grid
			grid: 'bootstrap5',  // N1ED bude používat Bootstrap 5 grid
			customBlocks: [
			{ name: 'card', label: 'Bootstrap Card', html: '<div class="card"><div class="card-body">Card Content</div></div>' }
			]
		},
		toolbar_mode: 'wrap',
		height: 500,
		menubar: true,
		toolbar: 'undo redo | blocks  | ' +
				'bold italic underline | alignleft aligncenter ' +
				'alignright alignjustify | bullist numlist outdent indent | ' +
				'link image table | removeformat code | n1ed | fullscreen',
		content_css: [
			'//www.tiny.cloud/css/codepen.min.css',
			'/assets/css/bootstrap.min.css',
			'/assets/fonts/bootstrap-icons-1.11.0/bootstrap-icons.min.css',
			{$cssFile},
		],
		file_picker_types: 'image',

		file_picker_callback: function (callback, value, meta) {
			if (meta.filetype === 'image') {
				window.tinyMceImageCallback = callback;

				window.open(
					'/administration/upload-manager',
					'UploadManager',
					'width=1200,height=800'
				);
			}
		},
	});
	</script>
	{/block}
</body>
</html>
